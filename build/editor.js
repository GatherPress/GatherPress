(()=>{"use strict";var e={n:t=>{var s=t&&t.__esModule?()=>t.default:()=>t;return e.d(s,{a:s}),s},d:(t,s)=>{for(var r in s)e.o(s,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:s[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.domReady;var s=e.n(t);const r=window.wp.data,a=window.moment;var i=e.n(a);const n=window.wp.i18n,o=(window.wp.element,window.wp.hooks);function d(e){if("object"==typeof GatherPress)return e.split(".").reduce(((e,t)=>e&&e[t]),GatherPress)}function c(e,t){if("object"!=typeof GatherPress)return;const s=e.split("."),r=s.pop();s.reduce(((e,t)=>{var s;return null!==(s=e[t])&&void 0!==s?s:e[t]={}}),GatherPress)[r]=t}window.wp.date,window.ReactJSXRuntime;const l="YYYY-MM-DD HH:mm:ss",m=i().tz(T()).add(1,"day").set("hour",18).set("minute",0).set("second",0).format(l),u=i().tz(m,T()).add(2,"hours").format(l);function p(){return function(){const e=[{label:(0,n.__)("1 hour","gatherpress"),value:1},{label:(0,n.__)("1.5 hours","gatherpress"),value:1.5},{label:(0,n.__)("2 hours","gatherpress"),value:2},{label:(0,n.__)("3 hours","gatherpress"),value:3},{label:(0,n.__)("Set an end timeâ€¦","gatherpress"),value:!1}];return(0,o.applyFilters)("gatherpress.durationOptions",e)}().find((e=>{return t=e.value,i().tz(function(){let e=d("eventDetails.dateTime.datetime_start");return e=""!==e?i().tz(e,T()).format(l):m,c("eventDetails.dateTime.datetime_start",e),e}(),T()).add(t,"hours").format(l)===function(){let e=d("eventDetails.dateTime.datetime_end");return e=""!==e?i().tz(e,T()).format(l):u,c("eventDetails.dateTime.datetime_end",e),e}();var t}))?.value||!1}function T(e=d("eventDetails.dateTime.timezone")){return i().tz.zone(e)?e:(0,n.__)("GMT","gatherpress")}function _(){const e=i().tz(d("eventDetails.dateTime.datetime_end"),T());return"gatherpress_event"===(0,r.select)("core/editor")?.getCurrentPostType()&&i().tz(T()).valueOf()>e.valueOf()}let v=!1;function g(){const e="gatherpress_event_communication",t=(0,r.dispatch)("core/notices"),s=(0,r.select)("core/editor").isSavingPost(),a=(0,r.select)("core/editor").isAutosavingPost();"publish"!==(0,r.select)("core/editor").getEditedPostAttribute("status")||"gatherpress_event"!==(0,r.select)("core/editor")?.getCurrentPostType()||!s||a||_()||v||(v=!0,t.removeNotice(e),t.createNotice("success",(0,n.__)("Send an event update to members via email?","gatherpress"),{id:e,isDismissible:!0,actions:[{onClick:()=>{((e,t="")=>{for(const[s,r]of Object.entries(e)){let e=s;t&&(e+="_"+String(t));const a=new CustomEvent(e,{detail:r});dispatchEvent(a)}})({setOpen:!0})},label:(0,n.__)("Compose Message","gatherpress")}]})),s||(v=!1)}const h=window.wp.blocks,E={dateTimeStart:d("eventDetails.dateTime.datetime_start")?d("eventDetails.dateTime.datetime_start"):m,dateTimeEnd:d("eventDetails.dateTime.datetime_end")?d("eventDetails.dateTime.datetime_end"):u,duration:null,timezone:d("eventDetails.dateTime.timezone")},D={setDateTimeStart:e=>(c("eventDetails.dateTime.datetime_start",e),{type:"SET_DATETIME_START",dateTimeStart:e}),setDateTimeEnd:e=>(c("eventDetails.dateTime.datetime_end",e),{type:"SET_DATETIME_END",dateTimeEnd:e}),setDuration:e=>({type:"SET_DURATION",duration:e}),setTimezone:e=>(c("eventDetails.dateTime.timezone",e),{type:"SET_TIMEZONE",timezone:e})},f=(0,r.createReduxStore)("gatherpress/datetime",{reducer:(e=E,t)=>{switch(t.type){case"SET_DATETIME_START":return{...e,dateTimeStart:t.dateTimeStart};case"SET_DATETIME_END":return{...e,dateTimeEnd:t.dateTimeEnd};case"SET_DURATION":return{...e,duration:t.duration};case"SET_TIMEZONE":return{...e,timezone:t.timezone};default:return e}},actions:D,selectors:{getDateTimeStart:e=>e.dateTimeStart,getDateTimeEnd:e=>e.dateTimeEnd,getDuration:e=>!1!==e.duration&&p(),getTimezone:e=>e.timezone}});(0,r.register)(f),s()((()=>{const e=(0,r.select)("core/edit-post");if(!e)return;const t=(0,r.dispatch)("core/edit-post");e.isEditorSidebarOpened()?(t.openGeneralSidebar("edit-post/document"),t.toggleEditorPanelOpened("gatherpress-event-settings/gatherpress-event-settings")):(t.openGeneralSidebar(),t.toggleEditorPanelOpened("gatherpress-event-settings/gatherpress-event-settings")),(0,r.subscribe)(g),function(){const e="gatherpress_event_past",t=(0,r.dispatch)("core/notices");t.removeNotice(e),_()&&t.createNotice("warning",(0,n.__)("This event has already passed.","gatherpress"),{id:e,isDismissible:!1})}()})),s()((()=>{Object.keys(d("misc.unregisterBlocks")).forEach((e=>{const t=d("misc.unregisterBlocks")[e];t&&void 0!==(0,h.getBlockType)(t)&&(0,h.unregisterBlockType)(t)}))}))})();