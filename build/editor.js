(()=>{"use strict";var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var s in a)e.o(a,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:a[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.domReady;var a=e.n(t);const s=window.wp.data,r=window.moment;var n=e.n(r);const i=window.wp.i18n;function o(e){if("object"==typeof GatherPress)return e.split(".").reduce(((e,t)=>e&&e[t]),GatherPress)}function d(e,t){if("object"!=typeof GatherPress)return;const a=e.split("."),s=a.pop();a.reduce(((e,t)=>{var a;return null!==(a=e[t])&&void 0!==a?a:e[t]={}}),GatherPress)[s]=t}window.wp.element,window.wp.date,window.ReactJSXRuntime;const u="YYYY-MM-DD HH:mm:ss",c=n().tz(T()).add(1,"day").set("hour",18).set("minute",0).set("second",0).format(u),m=n().tz(c,T()).add(2,"hours").format(u),l=[{label:(0,i.__)("1 hour","gatherpress"),value:1},{label:(0,i.__)("1.5 hours","gatherpress"),value:1.5},{label:(0,i.__)("2 hours","gatherpress"),value:2},{label:(0,i.__)("3 hours","gatherpress"),value:3},{label:(0,i.__)("Set an end timeâ€¦","gatherpress"),value:!1}];function T(e=o("eventDetails.dateTime.timezone")){return n().tz.zone(e)?e:(0,i.__)("GMT","gatherpress")}function p(){const e=n().tz(o("eventDetails.dateTime.datetime_end"),T());return"gatherpress_event"===(0,s.select)("core/editor")?.getCurrentPostType()&&n().tz(T()).valueOf()>e.valueOf()}let _=!1;function g(){const e="gatherpress_event_communication",t=(0,s.dispatch)("core/notices"),a=(0,s.select)("core/editor").isSavingPost(),r=(0,s.select)("core/editor").isAutosavingPost();"publish"!==(0,s.select)("core/editor").getEditedPostAttribute("status")||"gatherpress_event"!==(0,s.select)("core/editor")?.getCurrentPostType()||!a||r||p()||_||(_=!0,t.removeNotice(e),t.createNotice("success",(0,i.__)("Send an event update to members via email?","gatherpress"),{id:e,isDismissible:!0,actions:[{onClick:()=>{((e,t="")=>{for(const[a,s]of Object.entries(e)){let e=a;t&&(e+="_"+String(t));const r=new CustomEvent(e,{detail:s});dispatchEvent(r)}})({setOpen:!0})},label:(0,i.__)("Compose Message","gatherpress")}]})),a||(_=!1)}const E=window.wp.blocks,v={dateTimeStart:o("eventDetails.dateTime.datetime_start")?o("eventDetails.dateTime.datetime_start"):c,dateTimeEnd:o("eventDetails.dateTime.datetime_end")?o("eventDetails.dateTime.datetime_end"):m,duration:l.find((e=>{return t=e.value,n().tz(function(){let e=o("eventDetails.dateTime.datetime_start");return e=""!==e?n().tz(e,T()).format(u):c,d("eventDetails.dateTime.datetime_start",e),e}(),T()).add(t,"hours").format(u)===function(){let e=o("eventDetails.dateTime.datetime_end");return e=""!==e?n().tz(e,T()).format(u):m,d("eventDetails.dateTime.datetime_end",e),e}();var t}))?.value||!1,timezone:o("eventDetails.dateTime.timezone")},D={setDateTimeStart:e=>(d("eventDetails.dateTime.datetime_start",e),{type:"SET_DATETIME_START",dateTimeStart:e}),setDateTimeEnd:e=>(d("eventDetails.dateTime.datetime_end",e),{type:"SET_DATETIME_END",dateTimeEnd:e}),setDuration:e=>({type:"SET_DURATION",duration:e}),setTimezone:e=>(d("eventDetails.dateTime.timezone",e),{type:"SET_TIMEZONE",timezone:e})},h=(0,s.createReduxStore)("gatherpress/datetime",{reducer:(e=v,t)=>{switch(t.type){case"SET_DATETIME_START":return{...e,dateTimeStart:t.dateTimeStart};case"SET_DATETIME_END":return{...e,dateTimeEnd:t.dateTimeEnd};case"SET_DURATION":return{...e,duration:t.duration};case"SET_TIMEZONE":return{...e,timezone:t.timezone};default:return e}},actions:D,selectors:{getDateTimeStart:e=>e.dateTimeStart,getDateTimeEnd:e=>e.dateTimeEnd,getDuration:e=>e.duration,getTimezone:e=>e.timezone}});(0,s.register)(h);const S={latitude:0,longitude:0,mapCustomLatLong:!1},f=(0,s.createReduxStore)("gatherpress/venue",{reducer:(e=S,t)=>{switch(t.type){case"UPDATE_VENUE_LATITUDE":return{...e,latitude:t.latitude};case"UPDATE_VENUE_LONGITUDE":return{...e,longitude:t.longitude};case"UPDATE_MAP_CUSTOM_LAT_LONG":return{...e,mapCustomLatLong:t.mapCustomLatLong};default:return e}},actions:{updateVenueLatitude:e=>({type:"UPDATE_VENUE_LATITUDE",latitude:e}),updateVenueLongitude:e=>({type:"UPDATE_VENUE_LONGITUDE",longitude:e}),updateMapCustomLatLong:e=>({type:"UPDATE_MAP_CUSTOM_LAT_LONG",mapCustomLatLong:e})},selectors:{getVenueLatitude:e=>e.latitude,getVenueLongitude:e=>e.longitude,getMapCustomLatLong:e=>e.mapCustomLatLong}});(0,s.register)(f);const w={status:"no_status"},L=["no_status","attending","waiting_list","not_attending"],y="SET_STATUS",b={setStatus(e){const t=L.includes(e)?e:"no_status";return{type:y,status:t}}},A=(0,s.createReduxStore)("gatherpress/rsvp-status",{reducer:function(e=w,t){return t.type===y?{...e,status:t.status}:e},actions:b,selectors:{getStatus:e=>e.status},persist:!1});(0,s.register)(A),a()((()=>{const e=(0,s.select)("core/edit-post"),t=(0,s.dispatch)("core/edit-post");e&&t&&(e.isEditorSidebarOpened("edit-post/document")||t.openGeneralSidebar("edit-post/document"),(0,s.subscribe)(g),function(){const e="gatherpress_event_past",t=(0,s.dispatch)("core/notices");t.removeNotice(e),p()&&t.createNotice("warning",(0,i.__)("This event has already passed.","gatherpress"),{id:e,isDismissible:!1})}())})),a()((()=>{Object.keys(o("misc.unregisterBlocks")).forEach((e=>{const t=o("misc.unregisterBlocks")[e];t&&void 0!==(0,E.getBlockType)(t)&&(0,E.unregisterBlockType)(t)}))}))})();