(()=>{"use strict";var e={n:s=>{var t=s&&s.__esModule?()=>s.default:()=>s;return e.d(t,{a:t}),t},d:(s,t)=>{for(var r in t)e.o(t,r)&&!e.o(s,r)&&Object.defineProperty(s,r,{enumerable:!0,get:t[r]})}};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),e.o=(e,s)=>Object.prototype.hasOwnProperty.call(e,s);const s=window.wp.domReady;var t=e.n(s);const r=window.wp.element,n=window.wp.i18n,a=(e,s="")=>{for(const[t,r]of Object.entries(e)){let e=t;s&&(e+="_"+String(s)),addEventListener(e,(e=>{r(e.detail)}),!1)}};function i(e){if("object"==typeof GatherPress)return e.split(".").reduce(((e,s)=>e&&e[s]),GatherPress)}const o=window.ReactJSXRuntime,l=({item:e,activeItem:s=!1,count:t,onTitleClick:n,defaultLimit:a})=>{const{title:l,value:p}=e,c=!(0===t&&"attending"!==p),v=s?"span":"a",d=i("eventDetails.postId"),u=t>a;return(0,r.useEffect)((()=>{s&&((e,s="")=>{for(const[t,r]of Object.entries(e)){let e=t;s&&(e+="_"+String(s));const n=new CustomEvent(e,{detail:r});dispatchEvent(n)}})({setRsvpSeeAllLink:u},d)})),c?(0,o.jsxs)("div",{className:"gatherpress-rsvp-response__navigation-item",children:[(0,o.jsx)(v,{className:"gatherpress-rsvp-response__anchor","data-item":p,"data-toggle":"tab",href:"#",role:"tab","aria-controls":`#gatherpress-rsvp-${p}`,onClick:e=>n(e,p),children:l}),(0,o.jsxs)("span",{className:"gatherpress-rsvp-response__count",children:["(",t,")"]})]}):""},p=({items:s,activeValue:t,onTitleClick:n,defaultLimit:p})=>{var c;const v={all:0,attending:0,not_attending:0,waiting_list:0},d=null!==(c=i("eventDetails.responses"))&&void 0!==c?c:{};for(const[e,s]of Object.entries(d))v[e]=s.count;const[u,h]=(0,r.useState)(v),[g,m]=(0,r.useState)(!1),[_,f]=(0,r.useState)(!0),j=_?"span":"a";a({setRsvpCount:h},i("eventDetails.postId"));let x=0;const w=s.map(((e,s)=>{const r=e.value===t;return r&&(x=s),(0,o.jsx)(l,{item:e,count:u[e.value],activeItem:r,onTitleClick:n,defaultLimit:p},s)}));return(0,r.useEffect)((()=>{e.g.document.addEventListener("click",(({target:e})=>{e.closest(".gatherpress-rsvp-response__navigation-active")||m(!1)})),e.g.document.addEventListener("keydown",(({key:e})=>{"Escape"===e&&m(!1)}))})),(0,r.useEffect)((()=>{0===u.not_attending&&0===u.waiting_list?f(!0):f(!1)}),[u]),(0,o.jsxs)("div",{className:"gatherpress-rsvp-response__navigation-wrapper",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)(j,{href:"#",className:"gatherpress-rsvp-response__navigation-active",onClick:e=>(e=>{e.preventDefault(),m(!g)})(e),children:s[x].title}),"Â ",(0,o.jsxs)("span",{children:["(",u[t],")"]})]}),!_&&g&&(0,o.jsx)("nav",{className:"gatherpress-rsvp-response__navigation",children:w})]})},c=({items:e,activeValue:s,onTitleClick:t,rsvpLimit:l,setRsvpLimit:c,defaultLimit:v})=>{let d;d=!1===l?(0,n.__)("See fewer","gatherpress"):(0,n.__)("See all","gatherpress");let u=!1;const h=i("eventDetails.responses");var g;h&&h[s]&&(u=(null!==(g=i("eventDetails.responses")[s].count)&&void 0!==g?g:0)>v);const[m,_]=(0,r.useState)(u);return a({setRsvpSeeAllLink:_},i("eventDetails.postId")),(0,o.jsxs)("div",{className:"gatherpress-rsvp-response__header",children:[(0,o.jsx)("div",{className:"dashicons dashicons-groups"}),(0,o.jsx)(p,{items:e,activeValue:s,onTitleClick:t,defaultLimit:v}),m&&(0,o.jsx)("div",{className:"gatherpress-rsvp-response__see-all",children:(0,o.jsx)("a",{href:"#",onClick:e=>(e=>{e.preventDefault(),c(!1===l&&v)})(e),children:d})})]})},v=({value:e,limit:s,responses:t=[]})=>{let r="";return"object"==typeof t&&void 0!==t[e]&&(t=[...t[e].records],s&&(t=t.splice(0,s)),r=t.map(((e,s)=>{const{profile:t,name:r,photo:a,role:i}=e,{guests:l}=e;return(0,o.jsxs)("div",{className:"gatherpress-rsvp-response__item",children:[(0,o.jsx)("figure",{className:"gatherpress-rsvp-response__member-avatar",children:""!==t?(0,o.jsx)("a",{href:t,children:(0,o.jsx)("img",{alt:r,title:r,src:a})}):(0,o.jsx)("img",{alt:r,title:r,src:a})}),(0,o.jsxs)("div",{className:"gatherpress-rsvp-response__member-info",children:[(0,o.jsx)("div",{className:"gatherpress-rsvp-response__member-name",children:""!==t?(0,o.jsx)("a",{href:t,title:r,children:r}):(0,o.jsx)("span",{children:r})}),(0,o.jsx)("div",{className:"gatherpress-rsvp-response__member-role",children:i}),0!==l&&(0,o.jsx)("small",{className:"gatherpress-rsvp-response__guests",children:(0,n.sprintf)(/* translators: %d: Number of guests. */ /* translators: %d: Number of guests. */
(0,n._n)("+%d guest","+%d guests",l,"gatherpress"),l)})]})]},s)}))),(0,o.jsxs)(o.Fragment,{children:["attending"===e&&0===r.length&&(0,o.jsx)("div",{className:"gatherpress-rsvp-response__no-responses",children:!1===i("eventDetails.hasEventPast")?(0,n.__)("No one is attending this event yet.","gatherpress"):(0,n.__)("No one went to this event.","gatherpress")}),r]})},d=({items:e,activeValue:s,limit:t=!1})=>{const n=i("eventDetails.postId"),[l,p]=(0,r.useState)(i("eventDetails.responses"));a({setRsvpResponse:p},n);const c=e.map(((e,r)=>{const{value:n}=e;return n===s?(0,o.jsx)("div",{className:"gatherpress-rsvp-response__items",id:`gatherpress-rsvp-${n}`,role:"tabpanel","aria-labelledby":`gatherpress-rsvp-${n}-tab`,children:(0,o.jsx)(v,{value:n,limit:t,responses:l})},r):""}));return(0,o.jsx)("div",{className:"gatherpress-rsvp-response__content",children:c})},u=({defaultStatus:e="attending"})=>{const s=i("eventDetails.hasEventPast"),t=[{title:!1===s?(0,n._x)("Attending","RSVP status option for upcoming events","gatherpress"):(0,n._x)("Went","RSVP status option for past events","gatherpress"),value:"attending"},{title:!1===s?(0,n._x)("Waiting List","RSVP status option for upcoming events","gatherpress"):(0,n._x)("Wait Listed","RSVP status option for past events","gatherpress"),value:"waiting_list"},{title:!1===s?(0,n._x)("Not Attending","RSVP status option for upcoming events","gatherpress"):(0,n._x)("Didn't Go","RSVP status option for past events","gatherpress"),value:"not_attending"}],[l,p]=(0,r.useState)(e),[v,u]=(0,r.useState)(8);return a({setRsvpStatus:p},i("eventDetails.postId")),t.some((e=>e.value===l))||p(e),(0,o.jsxs)("div",{className:"gatherpress-rsvp-response",children:[(0,o.jsx)(c,{items:t,activeValue:l,onTitleClick:(e,s)=>{e.preventDefault(),p(s)},rsvpLimit:v,setRsvpLimit:u,defaultLimit:8}),(0,o.jsx)(d,{items:t,activeValue:l,limit:v})]})};t()((()=>{const e=document.querySelectorAll('[data-gatherpress_block_name="rsvp-response"]');for(let s=0;s<e.length;s++)(0,r.createRoot)(e[s]).render((0,o.jsx)(u,{}))}))})();