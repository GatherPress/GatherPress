(()=>{"use strict";var e,t={5733:(e,t,s)=>{const n=window.wp.blocks,a=window.React,r=window.wp.blockEditor,i=window.wp.element,l=window.wp.i18n,o=window.wp.components,c=(e,t="")=>{for(const[s,n]of Object.entries(e)){let e=s;t&&(e+="_"+String(t)),addEventListener(e,(e=>{n(e.detail)}),!1)}};function p(e){if("object"==typeof GatherPress)return e.split(".").reduce(((e,t)=>e&&e[t]),GatherPress)}window.wp.data;const m=({item:e,activeItem:t=!1,count:s,onTitleClick:n,defaultLimit:r})=>{const{title:l,value:o}=e,c=!(0===s&&"attending"!==o),m=t?"span":"a",v=p("post_id"),d=s>r;return(0,i.useEffect)((()=>{t&&((e,t="")=>{for(const[s,n]of Object.entries(e)){let e=s;t&&(e+="_"+String(t));const a=new CustomEvent(e,{detail:n});dispatchEvent(a)}})({setRsvpSeeAllLink:d},v)})),c?(0,a.createElement)("div",{className:"gp-rsvp-response__navigation-item"},(0,a.createElement)(m,{className:"gp-rsvp-response__anchor","data-item":o,"data-toggle":"tab",href:"#",role:"tab","aria-controls":`#gp-rsvp-${o}`,onClick:e=>n(e,o)},l),(0,a.createElement)("span",{className:"gp-rsvp-response__count"},"(",s,")")):""},v=({items:e,activeValue:t,onTitleClick:n,defaultLimit:r})=>{const l={all:0,attending:0,not_attending:0,waiting_list:0};for(const[e,t]of Object.entries(p("responses")))l[e]=t.count;const[o,v]=(0,i.useState)(l),[d,u]=(0,i.useState)(!1),[g,_]=(0,i.useState)(!0),h=g?"span":"a";c({setRsvpCount:v},p("post_id"));let f=0;const E=e.map(((e,s)=>{const i=e.value===t;return i&&(f=s),(0,a.createElement)(m,{key:s,item:e,count:o[e.value],activeItem:i,onTitleClick:n,defaultLimit:r})}));return(0,i.useEffect)((()=>{s.g.document.addEventListener("click",(({target:e})=>{e.closest(".gp-rsvp-response__navigation-active")||u(!1)})),s.g.document.addEventListener("keydown",(({key:e})=>{"Escape"===e&&u(!1)}))})),(0,i.useEffect)((()=>{0===o.not_attending&&0===o.waiting_list?_(!0):_(!1)}),[o]),(0,a.createElement)("div",{className:"gp-rsvp-response__navigation-wrapper"},(0,a.createElement)("div",null,(0,a.createElement)(h,{href:"#",className:"gp-rsvp-response__navigation-active",onClick:e=>(e=>{e.preventDefault(),u(!d)})(e)},e[f].title),"Â ",(0,a.createElement)("span",null,"(",o[t],")")),!g&&d&&(0,a.createElement)("nav",{className:"gp-rsvp-response__navigation"},E))},d=({items:e,activeValue:t,onTitleClick:s,rsvpLimit:n,setRsvpLimit:r,defaultLimit:o})=>{let m;m=!1===n?(0,l.__)("See fewer","gatherpress"):(0,l.__)("See all","gatherpress");const[d,u]=(0,i.useState)(p("responses")[t].count>o);return c({setRsvpSeeAllLink:u},p("post_id")),(0,a.createElement)("div",{className:"gp-rsvp-response__header"},(0,a.createElement)("div",{className:"dashicons dashicons-groups"}),(0,a.createElement)(v,{items:e,activeValue:t,onTitleClick:s,defaultLimit:o}),d&&(0,a.createElement)("div",{className:"gp-rsvp-response__see-all"},(0,a.createElement)("a",{href:"#",onClick:e=>(e=>{e.preventDefault(),r(!1===n&&o)})(e)},m)))},u=({value:e,limit:t,responses:s=[]})=>{let n="";return"object"==typeof s&&void 0!==s[e]&&(s=[...s[e].responses],t&&(s=s.splice(0,t)),n=s.map(((e,t)=>{const{profile:s,name:n,photo:r,role:i}=e;let{guests:l}=e;return l=l?" +"+l+" guest(s)":"",(0,a.createElement)("div",{key:t,className:"gp-rsvp-response__item"},(0,a.createElement)("figure",{className:"gp-rsvp-response__member-avatar"},(0,a.createElement)("a",{href:s},(0,a.createElement)("img",{alt:n,title:n,src:r}))),(0,a.createElement)("div",{className:"gp-rsvp-response__member-info"},(0,a.createElement)("div",{className:"gp-rsvp-response__member-name"},(0,a.createElement)("a",{href:s,title:n},n)),(0,a.createElement)("div",{className:"gp-rsvp-response__member-role"},i),(0,a.createElement)("small",{className:"gp-rsvp-response__guests"},l)))}))),(0,a.createElement)(a.Fragment,null,"attending"===e&&0===n.length&&(0,a.createElement)("div",{className:"gp-rsvp-response__no-responses"},!1===p("has_event_past")?(0,l.__)("No one is attending this event yet.","gatherpress"):(0,l.__)("No one went to this event.","gatherpress")),n)},g=({items:e,activeValue:t,limit:s=!1,editMode:n})=>{const r=p("post_id"),[l,m]=(0,i.useState)(p("responses")),v=[{name:"Attendees",triggerPrefix:"~",options:l.attending.responses,getOptionLabel:e=>(0,a.createElement)("span",null,(0,a.createElement)("span",{className:"icon"},e.visual),e.name),getOptionKeywords:e=>[e.name],isOptionDisabled:e=>"admin"===e.name,getOptionCompletion:e=>(0,a.createElement)("abbr",{title:e.name},e.visual)}];c({setRsvpResponse:m},r);const d=e.map(((e,r)=>{const{value:i}=e;return i===t?(0,a.createElement)("div",{key:r,className:"gp-rsvp-response__items",id:`gp-rsvp-${i}`,role:"tabpanel","aria-labelledby":`gp-rsvp-${i}-tab`},(0,a.createElement)(o.Autocomplete,{completers:v},(({listBoxId:e,activeId:t,onChange:s})=>(0,a.createElement)("div",null,(0,a.createElement)("input",{onChange:s,"aria-controls":e,"aria-activedescendant":t}),(0,a.createElement)("ul",{id:e})))),!n&&(0,a.createElement)(u,{value:i,limit:s,responses:l}),n&&(0,a.createElement)("div",null,(0,a.createElement)(o.Autocomplete,{completers:v},(({listBoxId:e,activeId:t,onChange:s})=>(0,a.createElement)("div",null,(0,a.createElement)("input",{onChange:s,"aria-controls":e,"aria-activedescendant":t}),(0,a.createElement)("ul",{id:e})))))):""}));return(0,a.createElement)("div",{className:"gp-rsvp-response__content"},d)},_=()=>{const e=p("has_event_past"),t=[{title:!1===e?(0,l.__)("Attending","gatherpress"):(0,l.__)("Went","gatherpress"),value:"attending"},{title:!1===e?(0,l.__)("Waiting List","gatherpress"):(0,l.__)("Wait Listed","gatherpress"),value:"waiting_list"},{title:!1===e?(0,l.__)("Not Attending","gatherpress"):(0,l.__)("Didn't Go","gatherpress"),value:"not_attending"}],[s,n]=(0,i.useState)("attending"),[r,m]=(0,i.useState)(8),[v,u]=(0,i.useState)(!1);c({setRsvpStatus:n},p("post_id"));const _=p("current_user").is_admin;return(0,a.createElement)("div",{className:"gp-rsvp-response"},(0,a.createElement)(d,{items:t,activeValue:s,onTitleClick:(e,t)=>{e.preventDefault(),n(t)},rsvpLimit:r,setRsvpLimit:m,defaultLimit:8}),_&&(0,a.createElement)(o.Button,{variant:"secondary",onClick:e=>{e.preventDefault(),u(!v)}},"Edit Attendees"),(0,a.createElement)(g,{items:t,activeValue:s,limit:r,editMode:v}))},h=e=>{const{isSelected:t}=e,s=t?"none":"block";return(0,a.createElement)("div",{style:{position:"relative"}},e.children,(0,a.createElement)("div",{style:{position:"absolute",top:"0",right:"0",bottom:"0",left:"0",display:s}}))},f=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":2,"name":"gatherpress/rsvp-response","version":"1.0.0","title":"RSVP Response","category":"gatherpress","icon":"groups","example":{},"description":"Displays a list of members who have confirmed their attendance for an event.","attributes":{"blockId":{"type":"string"},"content":{"type":"string"},"color":{"type":"string"}},"supports":{"html":false},"textdomain":"gatherpress","editorScript":"file:./index.js","style":"file:./style-index.css","viewScript":"file:./rsvp-response.js","render":"file:./render.php"}');(0,n.registerBlockType)(f,{edit:()=>{const e=(0,r.useBlockProps)();return(0,a.createElement)("div",{...e},(0,a.createElement)(h,null,(0,a.createElement)(_,null)))},save:()=>null})}},s={};function n(e){var a=s[e];if(void 0!==a)return a.exports;var r=s[e]={exports:{}};return t[e](r,r.exports,n),r.exports}n.m=t,e=[],n.O=(t,s,a,r)=>{if(!s){var i=1/0;for(p=0;p<e.length;p++){for(var[s,a,r]=e[p],l=!0,o=0;o<s.length;o++)(!1&r||i>=r)&&Object.keys(n.O).every((e=>n.O[e](s[o])))?s.splice(o--,1):(l=!1,r<i&&(i=r));if(l){e.splice(p--,1);var c=a();void 0!==c&&(t=c)}}return t}r=r||0;for(var p=e.length;p>0&&e[p-1][2]>r;p--)e[p]=e[p-1];e[p]=[s,a,r]},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={304:0,952:0};n.O.j=t=>0===e[t];var t=(t,s)=>{var a,r,[i,l,o]=s,c=0;if(i.some((t=>0!==e[t]))){for(a in l)n.o(l,a)&&(n.m[a]=l[a]);if(o)var p=o(n)}for(t&&t(s);c<i.length;c++)r=i[c],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(p)},s=globalThis.webpackChunkgatherpress=globalThis.webpackChunkgatherpress||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var a=n.O(void 0,[952],(()=>n(5733)));a=n.O(a)})();