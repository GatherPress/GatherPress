(()=>{"use strict";const e=window.wp.blocks,s=window.wp.blockEditor,t=window.wp.data;window.wp.i18n;const o=window.wp.element,n=window.ReactJSXRuntime,c=[["core/group",{},[["core/avatar"],["core/comment-author-name"]]]],r=({response:e,blocks:t,blockProps:o,activeRsvpId:r,setActiveRsvpId:i,firstRsvpId:l})=>{const{children:p,...v}=(0,s.useInnerBlocksProps)({},{template:c});return(0,n.jsxs)("div",{...v,children:[e.commentId===(r||l)?p:null,(0,n.jsx)(d,{blocks:t,commentId:e.commentId,setActiveRsvpId:i,isHidden:e.commentId===(r||l)})]})},d=(0,o.memo)((({blocks:e,commentId:t,setActiveRsvpId:o,isHidden:c})=>{const r=(0,s.__experimentalUseBlockPreview)({blocks:e}),d=()=>{o(t)},i={display:c?"none":void 0};return(0,n.jsx)("div",{...r,tabIndex:0,role:"button",style:i,onClick:d,onKeyPress:d})})),i=({responses:e,blocks:t,blockProps:o,activeRsvpId:c,setActiveRsvpId:d,firstRsvpId:i})=>(0,n.jsx)(n.Fragment,{children:e&&e.map((({commentId:e,...l},p)=>{console.log(e);const v=parseInt(e,10);return(0,n.jsx)(s.BlockContextProvider,{value:{commentId:v<0?null:v},children:(0,n.jsx)(r,{response:{commentId:v,...l},blockProps:o,blocks:t,activeRsvpId:c,setActiveRsvpId:d,firstRsvpId:i})},v||p)}))});(0,e.registerBlockType)("gatherpress/rsvp-template",{edit:({clientId:e,context:{postId:c}})=>{var r;const d=(0,s.useBlockProps)(),l=function(){if("object"==typeof GatherPress)return"eventDetails.responses".split(".").reduce(((e,s)=>e&&e[s]),GatherPress)}(),[p,v]=(0,o.useState)(null!==(r=parseInt(l.attending.responses[0]?.commentId,10))&&void 0!==r?r:null),{blocks:m}=(0,t.useSelect)((t=>{const{getBlocks:o}=t(s.store);return{blocks:o(e)}}),[e]);let a=[{commentId:-1}];return l.attending.responses.length&&(a=l.attending.responses),(0,n.jsx)(i,{responses:a,blockProps:d,blocks:m,activeRsvpId:p,setActiveRsvpId:v,firstRsvpId:a[0]?.commentId})},save:()=>(0,n.jsx)(s.InnerBlocks.Content,{})})})();