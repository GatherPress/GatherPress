(()=>{"use strict";var e,t={4337:(e,t,r)=>{const n=window.wp.blocks,a=window.moment;var s=r.n(a);function i(e){var t,r,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=i(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}const o=function(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=i(e))&&(n&&(n+=" "),n+=t);return n},l=window.wp.i18n,d=window.wp.blockEditor,m=window.wp.components,c=window.wp.data,u=window.wp.element;function p(){(0,c.dispatch)("core/editor")?.editPost({meta:{_non_existing_meta:!0}})}function h(){const e=(0,c.select)("core/editor")?.getCurrentPostType();return"gatherpress_event"===e||"gatherpress_venue"===e}function g(e){if("object"==typeof GatherPress)return e.split(".").reduce(((e,t)=>e&&e[t]),GatherPress)}function f(e,t){if("object"!=typeof GatherPress)return;const r=e.split("."),n=r.pop();r.reduce(((e,t)=>{var r;return null!==(r=e[t])&&void 0!==r?r:e[t]={}}),GatherPress)[n]=t}const x=window.wp.date,T=window.ReactJSXRuntime,v="YYYY-MM-DD HH:mm:ss",_=s().tz(b()).add(1,"day").set("hour",18).set("minute",0).set("second",0).format(v),D=s().tz(_,b()).add(2,"hours").format(v),j=[{label:(0,l.__)("1 hour","gatherpress"),value:1},{label:(0,l.__)("1.5 hours","gatherpress"),value:1.5},{label:(0,l.__)("2 hours","gatherpress"),value:2},{label:(0,l.__)("3 hours","gatherpress"),value:3},{label:(0,l.__)("Set an end timeâ€¦","gatherpress"),value:!1}];function z(e){return s().tz(y(),b()).add(e,"hours").format(v)}function S(){return C(g("settings.dateFormat"))+" "+C(g("settings.timeFormat"))}function b(e=g("eventDetails.dateTime.timezone")){return s().tz.zone(e)?e:(0,l.__)("GMT","gatherpress")}function w(e=""){const t=/^([+-])(\d{2}):(00|15|30|45)$/,r=e.replace(t,"$1");return r!==e?"UTC"+r+parseInt(e.replace(t,"$2")).toString()+e.replace(t,"$3").replace("00","").replace("15",".25").replace("30",".5").replace("45",".75"):e}function y(){let e=g("eventDetails.dateTime.datetime_start");return e=""!==e?s().tz(e,b()).format(v):_,f("eventDetails.dateTime.datetime_start",e),e}function E(e,t=null){!function(e){const t=s().tz(g("eventDetails.dateTime.datetime_end"),b()).valueOf(),r=s().tz(e,b()).valueOf();r>=t&&k(s().tz(r,b()).add(2,"hours").format(v))}(e),f("eventDetails.dateTime.datetime_start",e),"function"==typeof t&&t(e),p()}function k(e,t=null){!function(e){const t=s().tz(g("eventDetails.dateTime.datetime_start"),b()).valueOf(),r=s().tz(e,b()).valueOf();r<=t&&E(s().tz(r,b()).subtract(2,"hours").format(v))}(e),f("eventDetails.dateTime.datetime_end",e),null!==t&&t(e),p()}function C(e){const t={d:"DD",D:"ddd",j:"D",l:"dddd",N:"E",S:"o",w:"e",z:"DDD",W:"W",F:"MMMM",m:"MM",M:"MMM",n:"M",t:"",L:"",o:"YYYY",Y:"YYYY",y:"YY",a:"a",A:"A",B:"",g:"h",G:"H",h:"hh",H:"HH",i:"mm",s:"ss",u:"SSS",e:"zz",I:"",O:"",P:"",T:"",Z:"",c:"",r:"",U:"X"};return String(e).split("").map(((e,r,n)=>{const a=n[r-1];return e in t&&"\\"!==a?t[e]:e})).join("")}const O=e=>{const{dateTimeStart:t}=e;return s().tz(t,b()).format(S())},P=e=>{const{dateTimeEnd:t}=e;return s().tz(t,b()).format(S())},F=e=>{const{dateTimeStart:t,setDateTimeStart:r}=e,n=(0,x.getSettings)(),a=/a(?!\\)/i.test(n.formats.time.toLowerCase().replace(/\\\\/g,"").split("").reverse().join(""));return(0,T.jsx)(m.DateTimePicker,{currentDate:t,onChange:e=>{E(e,r)},is12Hour:a})},M=e=>{const{dateTimeEnd:t,setDateTimeEnd:r}=e,n=(0,x.getSettings)(),a=/a(?!\\)/i.test(n.formats.time.toLowerCase().replace(/\\\\/g,"").split("").reverse().join(""));return(0,T.jsx)(m.DateTimePicker,{currentDate:t,onChange:e=>k(e,r),is12Hour:a})};function Y(){const e="gatherpress_event_past",t=(0,c.dispatch)("core/notices");t.removeNotice(e),function(){const e=s().tz(g("eventDetails.dateTime.datetime_end"),b());return"gatherpress_event"===(0,c.select)("core/editor")?.getCurrentPostType()&&s().tz(b()).valueOf()>e.valueOf()}()&&t.createNotice("warning",(0,l.__)("This event has already passed.","gatherpress"),{id:e,isDismissible:!1})}const $=()=>{const{dateTimeStart:e,duration:t}=(0,c.useSelect)((e=>({dateTimeStart:e("gatherpress/datetime").getDateTimeStart(),duration:e("gatherpress/datetime").getDuration()})),[]),{setDateTimeStart:r,setDateTimeEnd:n}=(0,c.useDispatch)("gatherpress/datetime");return(0,u.useEffect)((()=>{r(s().tz(y(),b()).format(v)),t&&n(z(t)),Y()}),[e,t,r,n]),(0,T.jsx)(m.PanelRow,{children:(0,T.jsxs)(m.Flex,{direction:"column",gap:"1",children:[(0,T.jsx)(m.FlexItem,{children:(0,T.jsx)("h3",{style:{marginBottom:0},children:(0,T.jsx)("label",{htmlFor:"gatherpress-datetime-start",children:(0,l.__)("Date & time start","gatherpress")})})}),(0,T.jsx)(m.FlexItem,{children:(0,T.jsx)(m.Dropdown,{popoverProps:{placement:"bottom-end"},renderToggle:({isOpen:t,onToggle:r})=>(0,T.jsx)(m.Button,{id:"gatherpress-datetime-start",onClick:r,"aria-expanded":t,isLink:!0,children:(0,T.jsx)(O,{dateTimeStart:e})}),renderContent:()=>(0,T.jsx)(F,{dateTimeStart:e,setDateTimeStart:r})})})]})})},A=()=>{const{dateTimeEnd:e}=(0,c.useSelect)((e=>({dateTimeEnd:e("gatherpress/datetime").getDateTimeEnd()})),[]),{setDateTimeEnd:t}=(0,c.useDispatch)("gatherpress/datetime");return(0,u.useEffect)((()=>{t(s().tz(function(){let e=g("eventDetails.dateTime.datetime_end");return e=""!==e?s().tz(e,b()).format(v):D,f("eventDetails.dateTime.datetime_end",e),e}(),b()).format(v)),Y()})),(0,T.jsx)(m.PanelRow,{children:(0,T.jsxs)(m.Flex,{direction:"column",gap:"1",children:[(0,T.jsx)(m.FlexItem,{children:(0,T.jsx)("h3",{style:{marginBottom:0},children:(0,T.jsx)("label",{htmlFor:"gatherpress-datetime-end",children:(0,l.__)("Date & time end","gatherpress")})})}),(0,T.jsx)(m.FlexItem,{children:(0,T.jsx)(m.Dropdown,{popoverProps:{placement:"bottom-end"},renderToggle:({isOpen:t,onToggle:r})=>(0,T.jsx)(m.Button,{id:"gatherpress-datetime-end",onClick:r,"aria-expanded":t,isLink:!0,children:(0,T.jsx)(P,{dateTimeEnd:e})}),renderContent:()=>(0,T.jsx)(M,{dateTimeEnd:e,setDateTimeEnd:t})})})]})})},B=()=>{const{timezone:e}=(0,c.useSelect)((e=>({timezone:e("gatherpress/datetime").getTimezone()})),[]),{setTimezone:t}=(0,c.useDispatch)("gatherpress/datetime"),r=g("misc.timezoneChoices");return(0,u.useEffect)((()=>{t(g("eventDetails.dateTime.timezone"))}),[t]),(0,T.jsx)(m.PanelRow,{children:(0,T.jsx)(m.SelectControl,{label:(0,l.__)("Time Zone","gatherpress"),value:w(e),onChange:e=>{e=function(e=""){const t=/^UTC([+-])(\d+)(.\d+)?$/,r=e.replace(t,"$1");if(r!==e){const n=e.replace(t,"$2").padStart(2,"0");let a=e.replace(t,"$3");return""===a&&(a=":00"),a=a.replace(".25",":15").replace(".5",":30").replace(".75",":45"),r+n+a}return e}(e),t(e),p()},__nexthasnomarginbottom:!0,children:Object.keys(r).map((e=>(0,T.jsx)("optgroup",{label:e,children:Object.keys(r[e]).map((t=>(0,T.jsx)("option",{value:t,children:r[e][t]},t)))},e)))})})},H=()=>{const{duration:e}=(0,c.useSelect)((e=>({duration:e("gatherpress/datetime").getDuration()})),[]),t=(0,c.useDispatch)(),{setDateTimeEnd:r,setDuration:n}=t("gatherpress/datetime");return(0,T.jsx)(m.SelectControl,{label:(0,l.__)("Duration","gatherpress"),value:!!j.some((t=>t.value===e))&&e,options:j,onChange:e=>{(e="false"!==e&&parseFloat(e))&&r(z(e)),n(e)},__nexthasnomarginbottom:!0})},N=()=>{const e=(0,c.useDispatch)("core/editor").editPost;let t=(0,c.useSelect)((e=>e("core/editor").getEditedPostAttribute("meta")?.gatherpress_datetime));try{t=t?JSON.parse(t):{}}catch(e){t={}}const{dateTimeStart:r,dateTimeEnd:n,duration:a,timezone:i}=(0,c.useSelect)((e=>({dateTimeStart:e("gatherpress/datetime").getDateTimeStart(),dateTimeEnd:e("gatherpress/datetime").getDateTimeEnd(),duration:e("gatherpress/datetime").getDuration(),timezone:e("gatherpress/datetime").getTimezone()})),[]),{setDuration:o}=(0,c.useDispatch)("gatherpress/datetime");return(0,u.useEffect)((()=>{const l={gatherpress_datetime:JSON.stringify({...t,dateTimeStart:s().tz(r,i).format(v),dateTimeEnd:s().tz(n,i).format(v),timezone:i})};o(!!j.some((e=>z(e.value)===n))&&a),e({meta:l})}),[r,n,i,t,e,o,a]),(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("section",{children:(0,T.jsx)($,{})}),(0,T.jsx)("section",{children:a?(0,T.jsx)(H,{}):(0,T.jsx)(A,{})}),(0,T.jsx)("section",{children:(0,T.jsx)(B,{})})]})},G=(e,t,r)=>{const n=C(g("settings.dateFormat")),a=C(g("settings.timeFormat")),i=g("settings.showTimezone")?"z":"",o=n+" "+a;r=b(r);let d=n+" "+a+" "+i;return s().tz(e,r).format(n)===s().tz(t,r).format(n)&&(d=a+" "+i),(0,l.sprintf)(/* translators: %1$s: datetime start, %2$s: datetime end, %3$s timezone. */ /* translators: %1$s: datetime start, %2$s: datetime end, %3$s timezone. */
(0,l.__)("%1$s to %2$s %3$s","gatherpress"),s().tz(e,r).format(o),s().tz(t,r).format(d),function(e){return e=b(e),(0,l.__)("GMT","gatherpress")!==e?"":function(e=""){return e.replace(":","")}(g("eventDetails.dateTime.timezone"))}(r))},I=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"gatherpress/event-date","version":"2.0.0","title":"Event Date","category":"gatherpress","icon":"clock","example":{"viewportWidth":350},"description":"Displays the date and time for an event.","attributes":{"eventEnd":{"type":"string"},"eventStart":{"type":"string"},"textAlign":{"type":"string"}},"supports":{"html":false,"color":{"gradients":true,"link":true,"__experimentalDefaultControls":{"background":true,"text":true,"link":true}},"spacing":{"margin":true,"padding":true},"typography":{"fontSize":true,"lineHeight":true,"__experimentalFontFamily":true,"__experimentalFontWeight":true,"__experimentalFontStyle":true,"__experimentalTextTransform":true,"__experimentalTextDecoration":true,"__experimentalLetterSpacing":true,"__experimentalDefaultControls":{"fontSize":true}},"interactivity":{"clientNavigation":true},"__experimentalBorder":{"radius":true,"color":true,"width":true,"style":true,"__experimentalDefaultControls":{"radius":true,"color":true,"width":true,"style":true}}},"textdomain":"gatherpress","editorScript":"file:./index.js","style":"file:./style-index.css","render":"file:./render.php"}');(0,n.registerBlockType)(I,{edit:({attributes:{textAlign:e},setAttributes:t})=>{const r=(0,d.useBlockProps)({className:o({[`has-text-align-${e}`]:e})}),{dateTimeStart:n,dateTimeEnd:a,timezone:s}=(0,c.useSelect)((e=>({dateTimeStart:e("gatherpress/datetime").getDateTimeStart(),dateTimeEnd:e("gatherpress/datetime").getDateTimeEnd(),timezone:e("gatherpress/datetime").getTimezone()})),[]);return(0,T.jsxs)("div",{...r,children:[(0,T.jsx)(d.BlockControls,{children:(0,T.jsx)(d.AlignmentToolbar,{value:e,onChange:e=>t({textAlign:e})})}),G(n,a,s),h()&&(0,T.jsx)(d.InspectorControls,{children:(0,T.jsx)(m.PanelBody,{children:(0,T.jsx)(m.__experimentalVStack,{spacing:4,children:(0,T.jsx)(N,{})})})})]})},save:()=>null})}},r={};function n(e){var a=r[e];if(void 0!==a)return a.exports;var s=r[e]={exports:{}};return t[e](s,s.exports,n),s.exports}n.m=t,e=[],n.O=(t,r,a,s)=>{if(!r){var i=1/0;for(m=0;m<e.length;m++){for(var[r,a,s]=e[m],o=!0,l=0;l<r.length;l++)(!1&s||i>=s)&&Object.keys(n.O).every((e=>n.O[e](r[l])))?r.splice(l--,1):(o=!1,s<i&&(i=s));if(o){e.splice(m--,1);var d=a();void 0!==d&&(t=d)}}return t}s=s||0;for(var m=e.length;m>0&&e[m-1][2]>s;m--)e[m]=e[m-1];e[m]=[r,a,s]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={532:0,4:0};n.O.j=t=>0===e[t];var t=(t,r)=>{var a,s,[i,o,l]=r,d=0;if(i.some((t=>0!==e[t]))){for(a in o)n.o(o,a)&&(n.m[a]=o[a]);if(l)var m=l(n)}for(t&&t(r);d<i.length;d++)s=i[d],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(m)},r=globalThis.webpackChunkgatherpress=globalThis.webpackChunkgatherpress||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var a=n.O(void 0,[4],(()=>n(4337)));a=n.O(a)})();