import*as t from"@wordpress/interactivity";var e={d:(t,s)=>{for(var n in s)e.o(s,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:s[n]})}};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),e.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);const s=(n={getContext:()=>t.getContext,getElement:()=>t.getElement,store:()=>t.store},o={},e.d(o,n),o);var n,o;function r(t){if("object"==typeof GatherPress)return t.split(".").reduce(((t,e)=>t&&t[e]),GatherPress)}const{state:a,actions:i}=(0,s.store)("gatherpress",{actions:{updateRsvp(){var t,e;let s=null!==(t=null!==(e=a.rsvpStatus)&&void 0!==e?e:r("eventDetails.currentUser.status"))&&void 0!==t?t:"no_status";s="not_attending"===s||"no_status"===s?"attending":"not_attending",fetch(r("urls.eventApiUrl")+"/rsvp",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":r("misc.nonce")},body:JSON.stringify({post_id:r("eventDetails.postId"),status:s,guests:0,anonymous:0})}).then((t=>t.json())).then((t=>{t.success&&(a.activePostId=t.event_id,a.rsvpResponseStatus=t.status,a.rsvpStatus=t.status)})).catch((()=>{}))}},callbacks:{renderRsvpBlock(){var t,n;const o=(0,s.getElement)(),c=JSON.parse(o.ref.getAttribute("data-serialized-inner-blocks")),l=r("eventDetails.currentUser.status");if(!c||!c[null!==(t=a.rsvpStatus)&&void 0!==t?t:l])return;const u=(0,s.getContext)();fetch(r("urls.eventApiUrl")+"/rsvp-block-html",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":r("misc.nonce")},body:JSON.stringify({status:a.rsvpStatus,post_id:u.postId,block_data:c[null!==(n=a.rsvpStatus)&&void 0!==n?n:l]})}).then((t=>t.json())).then((t=>{t.success&&(o.ref.innerHTML=e.g.wp.dom.safeHTML(t.content),o.ref.querySelectorAll("[data-wp-interactive]").forEach((t=>{const e=t.getAttribute("data-wp-on--click");if(e&&e.startsWith("actions.")){const s=e.replace("actions.",""),n=i[s];"function"==typeof n&&t.addEventListener("click",(t=>n(t)))}})))})).catch((()=>{}))}}});